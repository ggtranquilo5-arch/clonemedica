<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fision+ - Gestão de Equipe</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --verde-escuro: #3e8e63;
            --verde-claro: #c2dfcc;
            --verde-hover: #2d6a4a;
            --cinza-fundo: #f8f9fa;
            --texto: #333;
            --branco: #ffffff;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Arial, sans-serif; }

        body {
            background-color: var(--cinza-fundo);
            background-image: linear-gradient(rgba(248, 249, 250, 0.9), rgba(248, 249, 250, 0.9)), url("imagem.pjp/Logo- prog WEB.png");
            background-size: cover; background-attachment: fixed;
            min-height: 100vh; padding: 15px;
        }

        .container {
            max-width: 1300px; margin: 0 auto;
            display: grid; grid-template-columns: 380px 1fr; gap: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.98); padding: 25px;
            border-radius: 15px; box-shadow: var(--shadow); backdrop-filter: blur(10px);
        }

        .avatar-upload { position: relative; max-width: 100px; margin: 0 auto 15px; text-align: center; }
        .avatar-preview {
            width: 100px; height: 100px; border-radius: 50%;
            border: 3px solid var(--verde-escuro); margin-bottom: 10px;
            background-size: cover; background-position: center;
            background-image: url('https://cdn-icons-png.flaticon.com/512/3135/3135715.png');
        }

        h2 { color: var(--verde-escuro); margin-bottom: 20px; font-size: 1.4rem; text-align: center; }

        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .full-width { grid-column: span 2; }

        .form-group { margin-bottom: 12px; display: flex; flex-direction: column; gap: 5px; }
        label { font-weight: 600; color: #555; font-size: 0.8rem; }
        input, select, textarea { padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 0.9rem; }

        .btn-save {
            background: var(--verde-escuro); color: white; border: none; padding: 14px;
            border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s;
            margin-top: 10px;
        }

        .prof-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; }
        
        .prof-card {
            background: white; border-radius: 15px; overflow: hidden;
            border: 1px solid #eee; transition: 0.3s;
        }
        .prof-card:hover { transform: translateY(-5px); box-shadow: var(--shadow); }

        .prof-header { background: var(--verde-escuro); height: 60px; position: relative; }
        .prof-img {
            width: 70px; height: 70px; border-radius: 50%; border: 3px solid white;
            position: absolute; bottom: -35px; left: 20px; background-size: cover;
        }

        .prof-body { padding: 45px 20px 20px; }
        .prof-body h3 { color: var(--verde-escuro); margin-bottom: 2px; }
        .prof-tag { font-size: 0.7rem; font-weight: bold; color: #888; text-transform: uppercase; margin-bottom: 10px; display: block; }
        
        .prof-contact-info { font-size: 0.85rem; color: #666; display: grid; gap: 5px; margin-top: 10px; }
        .prof-contact-info i { color: var(--verde-escuro); width: 18px; }

        .prof-footer { padding: 12px 20px; border-top: 1px solid #eee; display: flex; justify-content: flex-end; gap: 15px; }
        .btn-icon { background: none; border: none; cursor: pointer; color: #888; font-size: 0.9rem; }
        .btn-icon:hover { color: var(--verde-escuro); }

        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } .form-grid { grid-template-columns: 1fr; } .full-width { grid-column: span 1; } }
    </style>
</head>
<body>

    <div class="container">
        <aside class="card">
            <h2><i class="fas fa-user-md"></i> Perfil Profissional</h2>
            
            <div class="avatar-upload">
                <div class="avatar-preview" id="imagePreview"></div>
                <input type="file" id="imageUpload" accept="image/*" style="display:none">
                <button type="button" onclick="document.getElementById('imageUpload').click()" style="font-size: 0.7rem; cursor:pointer">Alterar Foto</button>
            </div>

            <input type="hidden" id="editId">
            <div class="form-grid">
                <div class="form-group full-width">
                    <label>Nome Completo</label>
                    <input type="text" id="profNome" placeholder="Dr. Nome Exemplo">
                </div>
                <div class="form-group">
                    <label>CPF</label>
                    <input type="text" id="profCPF" placeholder="000.000.000-00">
                </div>
                <div class="form-group">
                    <label>CREFITO</label>
                    <input type="text" id="profRegistro" placeholder="0000-F">
                </div>
                <div class="form-group full-width">
                    <label>Especialidade Principal</label>
                    <select id="profEspec">
                        <option value="Fisioterapia">Fisioterapia</option>
                        <option value="Osteopatia">Osteopatia</option>
                        <option value="Pilates">Pilates</option>
                        <option value="RPG">RPG</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>WhatsApp</label>
                    <input type="tel" id="profTelefone" placeholder="(00) 00000-0000">
                </div>
                <div class="form-group">
                    <label>E-mail (Gmail)</label>
                    <input type="email" id="profEmail" placeholder="exemplo@gmail.com">
                </div>
                <div class="form-group full-width">
                    <label>Resumo de Carreira</label>
                    <textarea id="profBio" rows="2" placeholder="Breve descrição profissional..."></textarea>
                </div>
            </div>
            
            <button class="btn-save" id="btnSalvar" onclick="salvarProfissional()">Salvar Profissional</button>
            <button class="btn-save" id="btnCancelar" onclick="resetForm()" style="display:none; background:#888;">Cancelar</button>
            
            <div style="text-align:center; margin-top:15px;">
                <a href="dashboard.html" style="text-decoration:none; color: var(--verde-escuro); font-size: 0.8rem; font-weight:bold;">
                    <i class="fas fa-chevron-left"></i> Voltar ao Painel
                </a>
            </div>
        </aside>

        <main class="card">
            <h2 style="text-align:left"><i class="fas fa-users-cog"></i> Profissionais da Unidade</h2>
            <div id="listaProfissionais" class="prof-grid"></div>
        </main>
    </div>

    <script>
        let profissionais = JSON.parse(localStorage.getItem('profissionaisFision')) || [];
        let currentImageData = "";

        // Preview da imagem
        document.getElementById('imageUpload').addEventListener('change', function(e) {
            const reader = new FileReader();
            reader.onload = function(e) {
                currentImageData = e.target.result;
                document.getElementById('imagePreview').style.backgroundImage = `url(${currentImageData})`;
            }
            if(e.target.files[0]) reader.readAsDataURL(e.target.files[0]);
        });

        function renderizar() {
            const grid = document.getElementById('listaProfissionais');
            grid.innerHTML = '';

            profissionais.forEach(p => {
                const img = p.foto || 'https://cdn-icons-png.flaticon.com/512/3135/3135715.png';
                grid.innerHTML += `
                    <div class="prof-card">
                        <div class="prof-header"><div class="prof-img" style="background-image: url(${img})"></div></div>
                        <div class="prof-body">
                            <span class="prof-tag">${p.espec}</span>
                            <h3>${p.nome}</h3>
                            <div class="prof-contact-info">
                                <span><i class="fas fa-id-card"></i> CPF: ${p.cpf || '---'}</span>
                                <span><i class="fas fa-certificate"></i> CREFITO: ${p.registro}</span>
                                <span><i class="fab fa-whatsapp"></i> ${p.telefone || '---'}</span>
                                <span><i class="far fa-envelope"></i> ${p.email || '---'}</span>
                            </div>
                        </div>
                        <div class="prof-footer">
                            <button class="btn-icon" onclick="prepararEdicao(${p.id})"><i class="fas fa-user-edit"></i></button>
                            <button class="btn-icon" onclick="removerProf(${p.id})" style="color:#d9534f"><i class="fas fa-trash-alt"></i></button>
                        </div>
                    </div>`;
            });
            localStorage.setItem('profissionaisFision', JSON.stringify(profissionais));
        }

        function salvarProfissional() {
            const id = document.getElementById('editId').value;
            const dados = {
                id: id ? Number(id) : Date.now(),
                nome: document.getElementById('profNome').value,
                cpf: document.getElementById('profCPF').value,
                registro: document.getElementById('profRegistro').value,
                espec: document.getElementById('profEspec').value,
                telefone: document.getElementById('profTelefone').value,
                email: document.getElementById('profEmail').value,
                bio: document.getElementById('profBio').value,
                foto: currentImageData
            };

            if (!dados.nome || !dados.registro) return alert("Nome e CREFITO são obrigatórios!");

            if (id) {
                profissionais = profissionais.map(p => p.id == id ? {...dados, foto: currentImageData || p.foto} : p);
            } else {
                profissionais.push(dados);
            }

            resetForm();
            renderizar();
        }

        function prepararEdicao(id) {
            const p = profissionais.find(p => p.id === id);
            document.getElementById('editId').value = p.id;
            document.getElementById('profNome').value = p.nome;
            document.getElementById('profCPF').value = p.cpf || "";
            document.getElementById('profRegistro').value = p.registro;
            document.getElementById('profEspec').value = p.espec;
            document.getElementById('profTelefone').value = p.telefone || "";
            document.getElementById('profEmail').value = p.email || "";
            document.getElementById('profBio').value = p.bio || "";
            document.getElementById('imagePreview').style.backgroundImage = `url(${p.foto || ''})`;
            
            document.getElementById('btnSalvar').innerText = "Atualizar Cadastro";
            document.getElementById('btnCancelar').style.display = "block";
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function resetForm() {
            document.getElementById('editId').value = "";
            document.querySelectorAll('input, select, textarea').forEach(el => el.value = "");
            document.getElementById('imagePreview').style.backgroundImage = "";
            currentImageData = "";
            document.getElementById('btnSalvar').innerText = "Salvar Profissional";
            document.getElementById('btnCancelar').style.display = "none";
        }

        function removerProf(id) {
            if(confirm("Deseja excluir permanentemente este profissional?")) {
                profissionais = profissionais.filter(p => p.id !== id);
                renderizar();
            }
        }

        renderizar();
    </script>
</body>
</html>