<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fision+ - Base de Clientes</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --verde-escuro: #3e8e63;
            --verde-claro: #c2dfcc;
            --verde-hover: #2d6a4a;
            --verde-suave: #e8f5e9;
            --cinza-fundo: #f8f9fa;
            --texto: #333;
            --branco: #ffffff;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
            --img-fundo: url("imagem.pjp/Logo- prog WEB.png"); 
        }

        /* COMANDO DE AJUSTE AUTOMÁTICO E TRAVA DE BORDAS */
        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
            font-family: 'Segoe UI', Arial, sans-serif;
            max-width: 100%; 
        }

        body {
            color: var(--texto);
            background-color: var(--cinza-fundo);
            background-image: linear-gradient(rgba(248, 249, 250, 0.9), rgba(248, 249, 250, 0.9)), var(--img-fundo);
            background-size: cover; background-position: center; background-attachment: fixed;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- HEADER PADRONIZADO --- */
        header {
            background: rgba(255, 255, 255, 0.98); padding: 10px 5%;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: var(--shadow); position: sticky; top: 0; z-index: 1000;
        }
        .nav-brand { display: flex; align-items: center; gap: 10px; text-decoration: none; color: inherit; }
        .logo-img { width: 40px; }

        .user-profile { 
            position: relative; cursor: pointer; display: flex; align-items: center; gap: 10px; 
            padding: 5px 15px; border-radius: 30px; background: #eee; 
        }
        
        /* DROPDOWN SIMPLIFICADO */
        .profile-dropdown {
            display: none; position: absolute; top: 120%; right: 0; background: var(--branco);
            box-shadow: var(--shadow); border-radius: 12px; min-width: 220px; z-index: 2000;
        }
        .profile-dropdown.show { display: block; }
        .profile-dropdown a { 
            display: block; padding: 15px; text-decoration: none; color: var(--texto); 
            font-weight: 600; transition: 0.3s;
        }
        .profile-dropdown a:hover { background: var(--verde-suave); color: var(--verde-escuro); }

        /* --- LAYOUT PRINCIPAL --- */
        .container {
            max-width: 1300px; margin: 20px auto;
            display: grid; grid-template-columns: 380px 1fr; gap: 20px;
            padding: 0 15px;
        }

        .card {
            background: rgba(255, 255, 255, 0.98); padding: 25px;
            border-radius: 15px; box-shadow: var(--shadow); backdrop-filter: blur(10px);
        }

        h2 { color: var(--verde-escuro); margin-bottom: 20px; font-size: 1.4rem; text-align: center; }

        /* Formulário */
        .form-group { margin-bottom: 12px; display: flex; flex-direction: column; gap: 5px; }
        label { font-weight: 600; color: #555; font-size: 0.85rem; }
        input, select { padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 0.9rem; width: 100%; }

        .btn-main {
            background: var(--verde-escuro); color: white; border: none; padding: 15px;
            border-radius: 10px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s;
            margin-top: 10px;
        }
        .btn-main:hover { background: var(--verde-hover); }

        /* Lista de Clientes */
        .search-box { margin-bottom: 20px; position: relative; }
        .search-box input { width: 100%; padding-left: 40px; border-radius: 25px; border: 1px solid #ddd; padding-top: 12px; padding-bottom: 12px; }
        .search-box i { position: absolute; left: 15px; top: 15px; color: #aaa; }

        .client-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 15px; }

        .client-card {
            background: white; border-radius: 12px; padding: 15px;
            border-left: 5px solid var(--verde-escuro); box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            display: flex; flex-direction: column; gap: 10px; transition: 0.3s;
        }
        .client-card:hover { transform: translateY(-3px); box-shadow: var(--shadow); }

        .client-header { display: flex; justify-content: space-between; align-items: flex-start; }
        .client-name { font-weight: bold; font-size: 1rem; color: var(--texto); }
        
        .status-badge { font-size: 0.65rem; padding: 3px 10px; border-radius: 12px; font-weight: bold; text-transform: uppercase; }
        .ativo { background: #d4edda; color: #155724; }
        .inativo { background: #f8d7da; color: #721c24; }

        .client-info { font-size: 0.85rem; color: #666; display: flex; flex-direction: column; gap: 4px; }
        .client-info i { color: var(--verde-escuro); width: 18px; }

        .client-footer {
            margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee;
            display: flex; justify-content: flex-end; gap: 15px;
        }

        .btn-action { background: none; border: none; cursor: pointer; color: #888; font-size: 1rem; transition: 0.2s; }
        .btn-action:hover { color: var(--verde-escuro); }

        /* RESPONSIVIDADE */
        @media (max-width: 900px) {
            .container { grid-template-columns: 1fr; }
            .user-profile span { display: none; }
        }
    </style>
</head>
<body>

    <header>
        <a href="telainicial.html" class="nav-brand">
            <img src="imagem.pjp/Logo- prog WEB.png" class="logo-img" alt="Logo">
            <h2 style="font-size: 1.2rem; margin:0;">Fision+</h2>
        </a>
        <div class="user-profile" onclick="toggleMenu(event)">
            <span>Base de Dados</span>
            <div style="width:35px; height:35px; background:var(--verde-escuro); border-radius:50%; color:white; display:flex; align-items:center; justify-content:center;">
                <i class="fas fa-users"></i>
            </div>
            <div class="profile-dropdown" id="clientDropdown">
                <a href="telainicial.html"><i class="fas fa-home"></i> Voltar ao Início</a>
            </div>
        </div>
    </header>

    <div class="container">
        <aside class="card">
            <h2><i class="fas fa-user-plus"></i> Novo Paciente</h2>
            <input type="hidden" id="clientId">
            
            <div class="form-group">
                <label>Nome do Paciente</label>
                <input type="text" id="clientNome" placeholder="Nome Completo">
            </div>
            
            <div class="form-group">
                <label>WhatsApp / Contato</label>
                <input type="tel" id="clientContato" placeholder="(00) 00000-0000">
            </div>

            <div class="form-group">
                <label>Status Inicial</label>
                <select id="clientStatus">
                    <option value="ativo">Ativo</option>
                    <option value="inativo">Inativo</option>
                </select>
            </div>

            <div class="form-group">
                <label>Data de Início/Visita</label>
                <input type="date" id="clientVisita">
            </div>

            <button class="btn-main" id="btnSalvar" onclick="salvarCliente()">Cadastrar Cliente</button>
            <button class="btn-main" id="btnCancelar" onclick="resetForm()" style="display:none; background:#888;">Cancelar</button>
        </aside>

        <main class="card">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="filtroNome" placeholder="Buscar paciente por nome..." onkeyup="renderizarClientes()">
            </div>

            <div id="listaClientes" class="client-grid"></div>
        </main>
    </div>

    <script>
        let clientes = JSON.parse(localStorage.getItem('clientesFision')) || [
            { id: 1, nome: "Ana Maria Silva", contato: "(11) 98888-7777", visita: "2024-05-20", status: "ativo" },
            { id: 2, nome: "João Pedro Santos", contato: "(11) 97777-6666", visita: "2024-05-15", status: "inativo" }
        ];

        function toggleMenu(event) {
            event.stopPropagation();
            document.getElementById("clientDropdown").classList.toggle("show");
        }

        window.onclick = function() {
            document.getElementById("clientDropdown").classList.remove("show");
        }

        function renderizarClientes() {
            const grid = document.getElementById('listaClientes');
            const busca = document.getElementById('filtroNome').value.toLowerCase();
            grid.innerHTML = '';

            clientes.filter(c => c.nome.toLowerCase().includes(busca)).forEach(c => {
                const dataBR = c.visita ? c.visita.split('-').reverse().join('/') : '--/--/----';

                grid.innerHTML += `
                    <div class="client-card">
                        <div class="client-header">
                            <span class="client-name">${c.nome}</span>
                            <span class="status-badge ${c.status}">${c.status}</span>
                        </div>
                        <div class="client-info">
                            <span><i class="fab fa-whatsapp"></i> ${c.contato}</span>
                            <span><i class="far fa-calendar-alt"></i> Última Visita: ${dataBR}</span>
                        </div>
                        <div class="client-footer">
                            <button class="btn-action" onclick="prepararEdicao(${c.id})" title="Editar"><i class="fas fa-user-edit"></i></button>
                            <button class="btn-action" onclick="removerCliente(${c.id})" style="color:#d9534f" title="Excluir"><i class="fas fa-trash-alt"></i></button>
                        </div>
                    </div>
                `;
            });
            localStorage.setItem('clientesFision', JSON.stringify(clientes));
        }

        function salvarCliente() {
            const id = document.getElementById('clientId').value;
            const nome = document.getElementById('clientNome').value;
            const contato = document.getElementById('clientContato').value;
            const status = document.getElementById('clientStatus').value;
            const visita = document.getElementById('clientVisita').value;

            if (!nome || !contato) return alert("Por favor, preencha o nome e o contato.");

            const dados = { id: id ? Number(id) : Date.now(), nome, contato, status, visita };

            if (id) {
                clientes = clientes.map(c => c.id == id ? dados : c);
            } else {
                clientes.push(dados);
            }

            resetForm();
            renderizarClientes();
        }

        function prepararEdicao(id) {
            const c = clientes.find(c => c.id === id);
            document.getElementById('clientId').value = c.id;
            document.getElementById('clientNome').value = c.nome;
            document.getElementById('clientContato').value = c.contato;
            document.getElementById('clientStatus').value = c.status;
            document.getElementById('clientVisita').value = c.visita;
            
            document.getElementById('btnSalvar').innerText = "Atualizar Cadastro";
            document.getElementById('btnCancelar').style.display = "block";
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function resetForm() {
            document.getElementById('clientId').value = "";
            document.getElementById('clientNome').value = "";
            document.getElementById('clientContato').value = "";
            document.getElementById('clientVisita').value = "";
            document.getElementById('btnSalvar').innerText = "Cadastrar Cliente";
            document.getElementById('btnCancelar').style.display = "none";
        }

        function removerCliente(id) {
            if(confirm("Deseja realmente excluir este paciente?")) {
                clientes = clientes.filter(c => c.id !== id);
                renderizarClientes();
            }
        }

        renderizarClientes();
    </script>
</body>
</html>