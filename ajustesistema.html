<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fision+ | Configurações</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --verde-primario: #3e8e63;
            --verde-secundario: #2d6a4a;
            --verde-suave: #e8f5e9;
            --bg-corpo: #f8f9fa;
            --branco: #ffffff;
            --texto-escuro: #2c3e50;
            --texto-suave: #7f8c8d;
            --danger: #d63031;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
            --img-fundo: url("imagem.pjp/Logo- prog WEB.png");
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Arial, sans-serif; max-width: 100%; }

        body {
            background-color: var(--bg-corpo);
            background-image: linear-gradient(rgba(248, 249, 250, 0.94), rgba(248, 249, 250, 0.94)), var(--img-fundo);
            background-size: cover; background-attachment: fixed;
            min-height: 100vh; overflow-x: hidden;
            display: flex; flex-direction: column;
        }

        header {
            background: rgba(255, 255, 255, 0.98); padding: 10px 5%;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: var(--shadow); position: sticky; top: 0; z-index: 1000;
        }
        .nav-brand { display: flex; align-items: center; gap: 10px; text-decoration: none; color: inherit; }
        .logo-img { width: 38px; }

        .user-profile { 
            position: relative; cursor: pointer; display: flex; align-items: center; gap: 10px; 
            padding: 5px 15px; border-radius: 30px; background: #eee; 
        }
        
        .profile-dropdown {
            display: none; position: absolute; top: 120%; right: 0; background: var(--branco);
            box-shadow: var(--shadow); border-radius: 12px; min-width: 180px; z-index: 2000;
        }
        .profile-dropdown.show { display: block; }
        .profile-dropdown a { display: block; padding: 12px 15px; text-decoration: none; color: var(--texto-escuro); font-weight: 600; }
        .profile-dropdown a:hover { background: var(--verde-suave); color: var(--verde-primario); }

        main { max-width: 1000px; margin: 20px auto; padding: 0 15px; flex-grow: 1; width: 100%; }

        .header-page { margin-bottom: 25px; }
        .header-page h1 { color: var(--verde-primario); font-size: 1.8rem; }
        .header-page p { color: var(--texto-suave); margin-top: 5px; }

        /* CARDS DE STATUS */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 20px; margin-bottom: 25px; }
        .stat-card {
            background: rgba(255, 255, 255, 0.95); padding: 20px; border-radius: 15px;
            box-shadow: var(--shadow); display: flex; align-items: center; gap: 15px;
        }
        .stat-icon {
            width: 48px; height: 48px; background: var(--verde-suave);
            color: var(--verde-primario); border-radius: 12px;
            display: flex; align-items: center; justify-content: center; font-size: 1.3rem;
        }

        /* CONFIG CARDS */
        .config-card { background: white; border-radius: 15px; box-shadow: var(--shadow); overflow: hidden; margin-bottom: 25px; }
        .config-header { 
            background: var(--verde-suave); padding: 15px 20px; 
            color: var(--verde-secundario);
        }
        .config-header h3 { font-size: 1.1rem; display: flex; align-items: center; gap: 10px; }
        .config-header p { font-size: 0.8rem; font-weight: normal; color: #5d8a71; margin-top: 2px; }
        
        .config-body { padding: 25px; }

        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .input-group { display: flex; flex-direction: column; gap: 8px; }
        .input-group label { font-size: 0.85rem; font-weight: 600; color: #555; }
        
        input { padding: 12px; border: 1px solid #ddd; border-radius: 10px; outline: none; transition: 0.3s; font-size: 0.95rem; }
        input:focus { border-color: var(--verde-primario); box-shadow: 0 0 5px rgba(62, 142, 99, 0.1); }

        .full-row { grid-column: 1 / -1; }

        .btn-save { 
            background: var(--verde-primario); color: white; border: none; padding: 14px 30px; 
            border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.3s;
        }
        .btn-save:hover { background: var(--verde-secundario); transform: translateY(-1px); }

        /* RODAPÉ E SAIR */
        .logout-section {
            background: #fff; border-top: 1px solid #eee; padding: 40px 20px;
            text-align: center; margin-top: 40px; border-radius: 20px 20px 0 0;
        }
        .btn-logout-final {
            background: transparent; color: var(--danger); border: 2px solid var(--danger);
            padding: 15px 40px; border-radius: 12px; font-weight: bold;
            cursor: pointer; transition: 0.3s; display: inline-flex; align-items: center; gap: 10px;
        }
        .btn-logout-final:hover { background: var(--danger); color: white; }

        @media (max-width: 600px) { .btn-logout-final { width: 100%; justify-content: center; } }
    </style>
</head>
<body>

    <header>
        <a href="telainicial.html" class="nav-brand">
            <img src="imagem.pjp/Logo- prog WEB.png" class="logo-img" alt="Logo">
            <h2 style="font-size: 1.2rem; margin:0;">Fision+</h2>
        </a>
        <div class="user-profile" onclick="toggleMenu(event)">
            <span>Opções</span>
            <div style="width:35px; height:35px; background:var(--verde-primario); border-radius:50%; color:white; display:flex; align-items:center; justify-content:center;"><i class="fas fa-cog"></i></div>
            <div class="profile-dropdown" id="menuDrop">
                <a href="telainicial.html"> <i class="fas fa-home"> </i>  Início </i></a>
            </div>
        </div>
    </header>

    <main>
        <section class="header-page">
            <h1>Configurações do Site</h1>
            <p>Gerencie as informações da clínica e do seu acesso</p>
        </section>

        <section class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-shield-alt"></i></div>
                <div>
                    <h4>Seguro</h4>
                    <p>Proteção de dados ativa</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="color:#2980b9; background:#e1f5fe;"><i class="fas fa-sync"></i></div>
                <div>
                    <h4>Backup</h4>
                    <p>Sincronizado via LocalStorage</p>
                </div>
            </div>
        </section>

        <div class="config-card">
            <div class="config-header">
                <h3><i class="fas fa-hospital"></i> Dados da Clínica</h3>
                <p>Informações que aparecem em recibos e relatórios.</p>
            </div>
            <div class="config-body">
                <form id="formClinica">
                    <div class="form-row">
                        <div class="input-group">
                            <label>Nome da Clínica</label>
                            <input type="text" id="clinicaNome" placeholder="Ex: Fision+ Atendimento">
                        </div>
                        <div class="input-group">
                            <label>CNPJ</label>
                            <input type="text" id="clinicaCnpj" placeholder="00.000.000/0000-00">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="input-group">
                            <label>Telefone / WhatsApp</label>
                            <input type="text" id="clinicaTel" placeholder="(00) 00000-0000">
                        </div>
                        <div class="input-group">
                            <label>E-mail de Contato</label>
                            <input type="email" id="clinicaEmail" placeholder="contato@clinica.com">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="input-group full-row">
                            <label>Endereço Completo</label>
                            <input type="text" id="clinicaEnd" placeholder="Rua, Número, Bairro, Cidade - UF">
                        </div>
                    </div>
                    <button type="button" class="btn-save" onclick="salvarDadosClinica()">Salvar Alterações</button>
                </form>
            </div>
        </div>

        <div class="config-card">
            <div class="config-header">
                <h3><i class="fas fa-database"></i> Segurança de Dados</h3>
            </div>
            <div class="config-body">
                <button class="btn-save" style="background:#2980b9; margin-bottom: 15px;" onclick="exportarBackup()">
                    <i class="fas fa-download"></i> Baixar Backup do Sistema
                </button>
                <div style="border: 1px solid #fab1a0; background: #fff5f5; border-radius: 10px; padding: 15px;">
                    <p style="color:var(--danger); font-size: 0.85rem; font-weight: bold;">Limpeza de Banco de Dados</p>
                    <p style="font-size: 0.75rem; color: #7f8c8d; margin-bottom: 10px;">Isso removerá todos os pacientes e prontuários.</p>
                    <button onclick="resetarTudo()" style="color:var(--danger); background:none; border: 1px solid var(--danger); padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.8rem;">Resetar Tudo</button>
                </div>
            </div>
        </div>
    </main>

    <footer class="logout-section">
        <button class="btn-logout-final" onclick="logout()">
            <i class="fas fa-power-off"></i> Sair do Sistema
        </button>
        <p style="margin-top: 20px; font-size: 0.75rem; color: #bbb;">Fision+ &copy; 2024</p>
    </footer>

    <script>
        function toggleMenu(e) { e.stopPropagation(); document.getElementById("menuDrop").classList.toggle("show"); }
        window.onclick = () => document.getElementById("menuDrop").classList.remove("show");

        // Carregar dados ao abrir a página
        window.onload = () => {
            const dados = JSON.parse(localStorage.getItem('dadosClinica')) || {};
            document.getElementById('clinicaNome').value = dados.nome || '';
            document.getElementById('clinicaCnpj').value = dados.cnpj || '';
            document.getElementById('clinicaTel').value = dados.tel || '';
            document.getElementById('clinicaEmail').value = dados.email || '';
            document.getElementById('clinicaEnd').value = dados.end || '';
        };

        function salvarDadosClinica() {
            const dados = {
                nome: document.getElementById('clinicaNome').value,
                cnpj: document.getElementById('clinicaCnpj').value,
                tel: document.getElementById('clinicaTel').value,
                email: document.getElementById('clinicaEmail').value,
                end: document.getElementById('clinicaEnd').value
            };
            localStorage.setItem('dadosClinica', JSON.stringify(dados));
            alert("Dados da clínica atualizados com sucesso!");
        }

        function exportarBackup() {
            const backup = {
                clinica: JSON.parse(localStorage.getItem('dadosClinica')),
                prontuarios: JSON.parse(localStorage.getItem('prontuariosFision')),
                fila: JSON.parse(localStorage.getItem('filaFision'))
            };
            const blob = new Blob([JSON.stringify(backup)], {type: "application/json"});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = "fision_plus_backup_completo.json";
            a.click();
        }

        function resetarTudo() {
            if(confirm("Deseja apagar todos os registros do sistema?")) {
                localStorage.clear();
                window.location.reload();
            }
        }

        function logout() {
            if(confirm("Encerrar sessão?")) window.location.href = 'index.html';
        }
    </script>
</body>
</html>